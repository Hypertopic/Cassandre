<!doctype html>
<html>
  <head>
    <title>{{fullname}}</title>
    {{>links}}
    <link rel="stylesheet" href="../style/cal-heatmap.css" />
  </head>
  <body>
    <div id="container">
      <nav id="header" class="{{>navbarstyle}} navbar-expand bd-navbar fixed-top">
        <a class="navbar-brand btn" id="diaries" data-toggle="tooltip" data-placement="bottom" title="{{i18n.i_diaries}}">
          <svg class="bi" width="24" height="24" fill="currentColor">
            <use xlink:href="../style/bootstrap-icons.svg#journals"/>
          </svg>
        </a>
        <button class="navbar-brand btn" id="avatar" class="creator {{id}} btn" data-toggle="tooltip" data-placement="bottom" title="{{i18n.i_select-avatar}}">
          <svg class="bi" width="24" height="24" fill="currentColor">
            <use xlink:href="../style/bootstrap-icons.svg#emoji-sunglasses"/>
          </svg>
        </button>
        <ul class="navbar-nav mr-auto"></ul>
        {{>log}}
      </nav>
      <main id="content" class="col pb-5">
        {{^authorized}}
          <h1>{{i18n.i_sign-in_required}}</h1>
        {{/authorized}}
        {{#authorized}}
        <h1>{{fullname}} <span id="contribution"></span></h1>
        <fieldset class="form-group">
          <legend class="col-form-label">
          {{#stats}}
          {{i18n.i_filter}}
          <a id="all-activity">{{i18n.i_all}} ({{all}})</a>
          <a class="d-none" id="only-created">{{i18n.i_creations}} ({{created}})</a>
          <a class="d-none" id="only-modified">{{i18n.i_modifications}} ({{modified}})</a>
          <a class="d-none" id="only-commented">{{i18n.i_comments}} ({{commented}})</a>
          {{/stats}}
          <div id="cal-heatmap"></div>
          </legend>
        </fieldset>
        {{>sponsor_rights}}
        <ul id="events">
        </ul>
        {{/authorized}}
      </main>
      <nav id="footer" class="{{>navbarstyle}} fixed-bottom">
        {{#authorized}}
        <div class='pagination'>
          <button class="btn navbar-btn btn-sm" id="next" title="{{i18n.i_show-more}}">
            <svg class="bi" width="24" height="24" fill="currentColor">
              <use xlink:href="../style/bootstrap-icons.svg#arrow-down-circle"/>
            </svg>
          </button>
        </div>
        {{/authorized}}
        <a class='navbar-text' href="https://github.com/Hypertopic/Cassandre/wiki">
          <svg class="bi" width="24" height="24" fill="currentColor">
            <use xlink:href="../style/bootstrap-icons.svg#info-circle"/>
          </svg>
        </a>
      </nav>
      <div id="avatar_dialog" class="modal fade" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">{{i18n.i_select_avatar}}</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">Ã—</span>
              </button>
            </div>
            <div class="modal-body text-center">
              <button id="fox" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_fox.svg"></button>
              <button id="ghost" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_ghost.svg"></button>
              <button id="abstract_01" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_abstract_01.svg"></button>
              <button id="abstract_02" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_abstract_02.svg"></button>
              <button id="abstract_03" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_abstract_03.svg"></button>
              <button id="heart" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_heart.svg"></button>
              <button id="balloon" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_balloon.svg"></button>
              <button id="house" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_house.svg"></button>
              <button id="book" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_book.svg"></button>
              <button id="incognito" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_incognito.svg"></button>
              <button id="briefcase" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_briefcase.svg"></button>
              <button id="melon" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_melon.svg"></button>
              <button id="cat" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_cat.svg"></button>
              <button id="pig" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_pig.svg"></button>
              <button id="celebration" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_celebration.svg"></button>
              <button id="sloth" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_sloth.svg"></button>
              <button id="dinosour" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_dinosour.svg"></button>
              <button id="soccerball" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_soccerball.svg"></button>
              <button id="dog" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_dog.svg"></button>
              <button id="sunset" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_sunset.svg"></button>
              <button id="drink" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_drink.svg"></button>
              <button id="surfboard" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_surfboard.svg"></button>
              <button id="football" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_football.svg"></button>
              <button id="tucan" type="button" class="btn btn-outline-secondary"><img src="/style/avatar_tucan.svg"></button>
            </div>
          </div>
        </div>
      </div> 
    </div>
  {{>script}}
  <script type="text/javascript" src="../script/d3.min.js"></script>
  <script type="text/javascript" src="../script/cal-heatmap.min.js"></script>
  <script>
  let fullnames = [],
      user_id = '{{id}}';
  {{^authorized}}
  stickToHeader();
  {{/authorized}}
  {{#authorized}}
  {{#stats}}
  let cal = new CalHeatMap(),
      converter = new showdown.Converter({strikethrough: 'true'}),
      avatars = [],
      all = {},
      created = {},
      commented = {},
      modified = {},
      end = new Date('{{end}}'),
      start = new Date('{{start}}');
  {{/stats}}
  $(document).ready(function() {
    coloringCreatorTag(user_id)
    stickToHeader();
    {{#activity}}
    if('{{date}}' > start.toJSON()) {
      all[unix_date('{{date}}')] = 1;
      switch('{{action}}') {
        case('commented'):
          commented[unix_date('{{date}}')] = 1;
        break;
        case('created'):
          created[unix_date('{{date}}')] = 1;
        break;
        case('modified'):
          modified[unix_date('{{date}}')] = 1;
        break;
      }
    }
    {{/activity}}
    {{#stats}}
    drawChart(all);
    if ({{commented}} > 0) $('#only-commented').removeClass('d-none');
    if ({{created}} > 0) $('#only-created').removeClass('d-none');
    if ({{modified}} > 0) $('#only-modified').removeClass('d-none');
    {{/stats}}
    showMore('a');
  });

  {{/authorized}}
  {{>layoutscript}}
  {{>logscript}}
  </script>
  <script src="../script/user.js"></script>
  </body>
</html>

